<%- include("../../views/partials/user/header") %>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Order History</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
  <div class="container my-5">
    <h2 class="text-center text-danger mb-4">Order History</h2>
    <% if (orders.length > 0) { %>
      <% orders.forEach(order => { %>
        <div class="card mb-4">
          <div class="card-header">
            <h5 class="text-success">Order ID: <%= order.orderId.slice(-5) %></h5>
            <p>Order Date: <%= order.createdOn.toDateString() %></p>
            <p class="text-danger">Status: <%= order.Status %></p>
          </div>
          <div class="card-body">

            <h6>Shipping Address</h6>
            <% if (order.address) { %>
              <p><strong>Name:</strong> <%= order.address.name %></p>
              <p><strong>City:</strong> <%= order.address.city %></p>
              <p><strong>Street Mark:</strong> <%= order.address.StreetMark %></p>
              <p><strong>State:</strong> <%= order.address.state %></p>
              <p><strong>Pincode:</strong> <%= order.address.pincode %></p>
              <p><strong>Phone:</strong> <%= order.address.Phone %></p>
              <p><strong>Second Phone:</strong> <%= order.address.SecondPhone %></p>
              <p><strong>House No:</strong> <%= order.address.Houseno %></p>
            <% } else { %>
              <p>Address details not available.</p>
            <% } %>

            <h6>Ordered Items</h6>
            <table class="table">
              <thead>
                <tr>
                  <th>Product Name</th>
                  <th>Quantity</th>
                  <th>Price</th>
                </tr>
              </thead>
              <tbody>
                <% order.orderedItems.forEach(item => { %>
                  <tr>
                    <td><%= item.product.productname %></td>
                    <td><%= item.quantity %></td>
                    <td>₹<%= item.price %></td>
                  </tr>
                <% }) %>
              </tbody>
            </table>

            <h6>Payment Summary</h6>
            <p><strong>Payment Method:</strong> <%= order.paymentMethod %></p>
            <p><strong>Total Price:</strong> ₹<%= order.totalPrice %></p>
            <p><strong>Discount:</strong> ₹<%= order.discount %></p>
            <p><strong>Final Amount:</strong> ₹<%= order.finalAmount %></p>
          </div>
        </div>
      <% }) %>
    <% } else { %>
      <p class="text-center">You have no orders yet.</p>
    <% } %>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
<%- include("../../views/partials/user/footer") %>